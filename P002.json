{
  "Description": "Rimozione servizi e bloatware per Windows 11",
  "Order": "P002",
  "PS": [
    {
      "Nome": "Disattivazioni Servizi",
      "Command": [
    "$services = @(", 
    "    'diagnosticshub.standardcollector.service'",   
    "    'DiagTrack'",                                  
    "    'dmwappushservice'",                           
    "    'lfsvc'",                                      
    "    'MapsBroker'",                                 
    "    'NetTcpPortSharing'",                          
    "    'RemoteAccess'",                               
    "    'RemoteRegistry'",                             
    "    'SharedAccess'",                               
    "    'TrkWks'",                                     
    "    'WbioSrvc'",                                   
    "    'WMPNetworkSvc'",                              
    "    'XblAuthManager'",                             
    "    'XblGameSave'",                                
    "    'XboxNetApiSvc'",                              
    "    'ndu'",                                        
    ")", 
    "", 
    "foreach ($service in $services) {", 
    "    Get-Service -Name $service | Set-Service -StartupType Disabled", 
    "}"
   ]
    },
    {
     "Nome": "Disattivazioni Servizi",
     "Command": [
    "$Services = @(", 
    "    'MixedRealityOpenXRSvc' # Mixed Reality", 
    "    'WMPNetworkSvc' # Windows Media Player Sharing", 
    "    'WerSvc' # Error Reporting", 
    "    'WalletService' # Wallet Service", 
    "    'SysMain' # SuperFetch - Safe to disable if you have a SSD", 
    "    'SCPolicySvc' # Smart Card Removal Policy", 
    "    'ScDeviceEnum' # Smart Card Device Enumeration Service", 
    "    'SCardSvr' # Smart Card", 
    "    'RetailDemo' # Retail Demo Service", 
    "    'WpcMonSvc' # Parental Controls", 
    "    '*diagnosticshub*' # Microsoft (R) Diagnostics Hub Standard Collector Service", 
    "    'MapsBroker' # Downloaded Maps Manager", 
    "    'TrkWks' # Distributed Link Tracking Client", 
    "    'WdiSystemHost' # Diagnostic System Host", 
    "    'WdiServiceHost' # Diagnostic Service Host", 
    "    'DPS' # Diagnostic Policy Service", 
    "    'diagsvc' # Diagnostic Execution Service", 
    ")", 
    "", 
    "# Disable Services listed above", 
    "foreach ($Service in $Services) {", 
    "    Get-Service -Name $Service -ErrorAction SilentlyContinue | Set-Service -StartupType Disabled", 
    "    if ((Get-Service -Name $Service -ErrorAction SilentlyContinue).Status -eq 'Running') {", 
    "        Stop-Service -Name $Service -Force -ErrorAction SilentlyContinue | Out-Null", 
    "    }", 
    "}"
]
    },
    {
     "Nome": "Disattivazioni Gruppi",
     "Command": [
    "$groups = @(", 
    "    'Accessibility'", 
    "    'AppSync'", 
    "    'BrowserSettings'", 
    "    'Credentials'", 
    "    'DesktopTheme'", 
    "    'Language'", 
    "    'PackageState'", 
    "    'Personalization'", 
    "    'StartLayout'", 
    "    'Windows'", 
    ")", 
    "", 
    "foreach ($group in $groups) {", 
    "    Set-ItemProperty -Path \"HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\SettingSync\\Groups\\$group\" -Name \"Enabled\" -Value 0", 
    "}"
]
    },
    {
     "Nome": "Disattivazioni Task",
     "Command": [
    "[Array] @(", 
    "    '\\Microsoft\\Windows\\ApplicationData\\CleanupTemporaryState'", 
    "    '\\Microsoft\\Windows\\ApplicationData\\DsSvcCleanup'", 
    "    '\\Microsoft\\Windows\\AppxDeploymentClient\\Pre-stagedappcleanup'", 
    "    '\\Microsoft\\Windows\\Autochk\\Proxy'", 
    "    '\\Microsoft\\Windows\\BrokerInfrastructure\\BgTaskRegistrationMaintenanceTask'", 
    "    '\\Microsoft\\Windows\\capabilityaccessmanager\\maintenancetasks'", 
    "    '\\Microsoft\\Windows\\Chkdsk\\ProactiveScan'", 
    "    '\\Microsoft\\Windows\\Chkdsk\\SyspartRepair'", 
    "    '\\Microsoft\\Windows\\Clip\\LicenseValidation'", 
    "    '\\Microsoft\\Windows\\CloudExperienceHost\\CreateObjectTask'", 
    "    '\\Microsoft\\Windows\\CustomerExperienceImprovementProgram\\Consolidator'", 
    "    '\\Microsoft\\Windows\\CustomerExperienceImprovementProgram\\UsbCeip'", 
    "    '\\Microsoft\\Windows\\Defrag\\ScheduledDefrag'", 
    "    '\\Microsoft\\Windows\\DeviceInformation\\Device'", 
    "    '\\Microsoft\\Windows\\DeviceInformation\\DeviceUser'", 
    "    '\\Microsoft\\Windows\\DeviceSetup\\MetadataRefresh'", 
    "    '\\Microsoft\\Windows\\ExploitGuard\\ExploitGuardMDMpolicyRefresh'", 
    "    '\\Microsoft\\Windows\\Feedback\\Siuf\\DmClient'", 
    "    '\\Microsoft\\Windows\\Feedback\\Siuf\\DmClientOnScenarioDownload'", 
    "    '\\Microsoft\\Windows\\FileHistory\\FileHistory*'", 
    "    '\\Microsoft\\Windows\\Location\\Notifications'", 
    "    '\\Microsoft\\Windows\\Location\\WindowsActionDialog'", 
    "    '\\Microsoft\\Windows\\Maps\\MapsToastTask'", 
    "    '\\Microsoft\\Windows\\Maps\\MapsUpdateTask'", 
    "    '\\Microsoft\\Windows\\MemoryDiagnostic\\ProcessMemoryDiagnosticEvents'", 
    "    '\\Microsoft\\Windows\\MemoryDiagnostic\\RunFullMemoryDiagnostic'", 
    "    '\\Microsoft\\Windows\\MUI\\LPRemove'", 
    "    '\\Microsoft\\Windows\\Multimedia\\SystemSoundsService'", 
    "    '\\Microsoft\\Windows\\OfflineFiles\\BackgroundSynchronization'", 
    "    '\\Microsoft\\Windows\\OfflineFiles\\LogonSynchronization'", 
    "    '\\Microsoft\\Windows\\Printing\\EduPrintProv'", 
    "    '\\Microsoft\\Windows\\Printing\\PrinterCleanupTask'", 
    "    '\\Microsoft\\Windows\\PushToInstall\\LoginCheck'", 
    "    '\\Microsoft\\Windows\\PushToInstall\\Registration'", 
    "    '\\Microsoft\\Windows\\RetailDemo\\CleanupOfflineContent'", 
    "    '\\Microsoft\\Windows\\Servicing\\StartComponentCleanup'", 
    "    '\\Microsoft\\Windows\\Setup\\SetupCleanupTask'", 
    "    '\\Microsoft\\Windows\\SharedPC\\AccountCleanup'", 
    "    '\\Microsoft\\Windows\\UNP\\RunUpdateNotificationMgr'", 
    "    '\\Microsoft\\Windows\\WindowsErrorReporting\\QueueReporting'", 
    "    '\\Microsoft\\XblGameSave\\XblGameSaveTask'", 
    ") | ForEach-Object {", 
    "    Disable-ScheduledTask -TaskName $_ -ErrorAction SilentlyContinue | Out-Null", 
    "}"
]
    },
    {
     "Nome": "Disattivazioni Task",
     "Command": [
    "$tasks = @(",
    "    '\\Microsoft\\Windows\\Application Experience\\Microsoft Compatibility Appraiser'",
    "    '\\Microsoft\\Windows\\Application Experience\\ProgramDataUpdater'",
    "    '\\Microsoft\\Windows\\Application Experience\\StartupAppTask'",
    "    '\\Microsoft\\Windows\\Application Experience\\PcaPatchDbTask'",
    ")",
    "",
    "foreach ($task in $tasks) {",
    "    Disable-ScheduledTask -TaskName $task -ErrorAction SilentlyContinue",
    "}"
]
    }
  ]
}

